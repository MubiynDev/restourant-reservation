<!DOCTYPE html>
<html>
<title>Restourant || <%=title%></title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="/style/dashboard.css">
<link rel="stylesheet" type="text/css" href="/style/reservation.css"> 



 
<meta name="viewport" content="width=device-width, initial-scale=1">
<body>
    <nav>
        <div class="container">
             <div class="logo">
                <h1>Logo</h1>
             </div>
             <div class="user">
                <h1>Welcome <span style="color: rgb(60, 135, 37);"><%=user.username %>  </span></h1>
                <a href="/admin/logout">Log Out</a>
             </div> 
        </div>
    </nav>

    <section class="reservations">
        <div class="container">
            <div class="wrapper">

                <div class="reservations-nav">
                    <button class="add-new" aria-label="add-new"  data-bs-toggle="modal" data-bs-target="#add-reservation">Add New+</button>

                    <!-- <div class="sort">
                        <h5>Get by Date:</h5>
                        <div id='check-in' class='form-field'>
                            <input type="date" name="date" class="dateRes get-by-date" value="" placeholder="9 July, 2022">
                        </div>
                        <button class="sort-submit" type="submit">Ok</button>

                    </div> -->
                </div>

                <div class="reservations-body">
                  <% data?.forEach(item => { %> 
                    <div class="res-item">
                        <h1><%=item.firstName%> </h1>
                        <h1><%=item.lastName%></h1>
                        <h1><%=item.date%></h1>
                        <div class="table">
                            <h1>peoples: <%=item.people%> </h1>
                            <h1>table: <%=item.table_number%></h1>
                        </div>
                        <div class="edition">
                            <a href="" class="edit-res" aria-label="edit-res-<%=item._id.toString() %> "  data-bs-toggle="modal" data-bs-target="#edit-res-<%=item._id.toString() %> " data-id="<%=item._id.toString() %>">edit</a>
                            <button  class="delete-res" data-id="<%=item._id.toString() %>">delete</button>
                        </div>
                    </div>



                    <div class="modal fade" id="edit-res-<%=item._id.toString() %>" tabindex="-1" aria-labelledby="edit-res-<%=item._id.toString() %> " aria-hidden="true">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel">Edit Reservation</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body">
                                    
                                    <form method="POST" action="/admin/update/<%=item._id.toString()%>">
                                        <ul class='booking-widget__form'>
                                         <li>
                                                <label for='check-in'>First Name</label>
                                                <div id='check-in' class='form-field'>
                                                    <input type="text" name="firstName" class="dateRes" value="<%=item.firstName %> " placeholder="John">
                                                    <div class='datepicker'><i class="fas fa-users"></i>/div>
                                                </div>
                                            </li>
                                            <li>
                                                <label for='check-in'>Last Name</label>
                                                <div id='check-in' class='form-field'>
                                                    <input type="text" name="lastName" class="dateRes" value="<%=item.lastName %> " placeholder="Doe">
                                                    <div class='datepicker'><i class="fas fa-users"></i></div>
                                                </div>
                                            </li>
                                            <li>
                                                <label for='check-in'>Select Date</label>
                                                <div id='check-in' class='form-field'>
                                                    <input type="date" name="date" class="dateRes" value="" placeholder="9 July, 2022">
                                                    <div class='datepicker'><i class="fa fa-calendar" aria-hidden="true"></i></div>
                                                </div>
                                            </li>
                                
                                            <li>
                                                <div class='form__dropdown'>
                                                    <label for='adultsAmount'>How Many People</label>
                                                    <div class='form-field'> 
                                                    <select id='adultsAmount' name="people"> 
                                                            <option value="0" selected="selected"></option>     
                                                            <option value="1">1</option>
                                                            <option value="2">2</option>
                                                            <option value="3">3</option>
                                                            <option value="4">4</option>
                                                            <option value="5">5</option>
                                                            <option value="6">6</option>
                                                    </select>
                                                    <div class='select-button'><i class="fa fa-caret-down" aria-hidden="true"></i></div>
                                                </div>
                                                </div>
                                                <div class='form__dropdown'>
                                                    <label for='childrenAmount'>Table Number</label>
                                                    <br>
                                                  <div class='form-field'> 
                                                    <select id='childrenAmount' name="table_number" class="table-num"> 
                                                            <option value="0" selected="selected"></option>                        
                                                            <option value="1">1</option>
                                                            <option value="2">2</option>
                                                            <option value="3">3</option>
                                                            <option value="4">4</option>
                                                            <option value="5">5</option>
                                                            <option value="6">6</option>
                                                            <option value="7">7</option>
                                                            <option value="8">8</option>
                                                            <option value="9">9</option>
                                                            <option value="10">10</option>
                                                    </select>
                                                    <div class='select-button'><i class="fa fa-caret-down" aria-hidden="true"></i></div>
                                                    </div>
                                                </div>
                                            </li>
                                            <li>
                                                <button type="submit" id='bookingSubmit' class='form__submit' value='Send Reservation'>
                                            </li>
                                        </ul>       
                                    </form>
                
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </div>
                    </div>
                <%  }) %> 


                    

                </div>
            </div>
        </div>
    </section>


    <div class="modal fade" id="add-reservation" tabindex="-1" aria-labelledby="add-new" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">New Reservation</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    
                    <form method="POST" action="/admin/create">
                        <ul class='booking-widget__form'>
                         <li>
                                <label for='check-in'>First Name</label>
                                <div id='check-in' class='form-field'>
                                    <input type="text" name="firstName" class="dateRes" value="" placeholder="John">
                                    <div class='datepicker'><i class="fas fa-users"></i>/div>
                                </div>
                            </li>
                            <li>
                                <label for='check-in'>Last Name</label>
                                <div id='check-in' class='form-field'>
                                    <input type="text" name="lastName" class="dateRes" value="" placeholder="Doe">
                                    <div class='datepicker'><i class="fas fa-users"></i></div>
                                </div>
                            </li>
                            <li>
                                <label for='check-in'>Select Date</label>
                                <div id='check-in' class='form-field'>
                                    <input type="date" name="date" class="dateRes" value="" placeholder="9 July, 2022">
                                    <div class='datepicker'><i class="fa fa-calendar" aria-hidden="true"></i></div>
                                </div>
                            </li>
                
                            <li>
                                <div class='form__dropdown'>
                                    <label for='adultsAmount'>How Many People</label>
                                    <div class='form-field'> 
                                    <select id='adultsAmount' name="people"> 
                                            <option value="0" selected="selected"></option>     
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5</option>
                                            <option value="6">6</option>
                                    </select>
                                    <div class='select-button'><i class="fa fa-caret-down" aria-hidden="true"></i></div>
                                </div>
                                </div>
                                <div class='form__dropdown'>
                                    <label for='childrenAmount'>Table Number</label>
                                    <br>
                                  <div class='form-field'> 
                                    <select id='childrenAmount' name="table_number" class="table-num"> 
                                            <option value="0" selected="selected"></option>                        
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5</option>
                                            <option value="6">6</option>
                                            <option value="7">7</option>
                                            <option value="8">8</option>
                                            <option value="9">9</option>
                                            <option value="10">10</option>
                                    </select>
                                    <div class='select-button'><i class="fa fa-caret-down" aria-hidden="true"></i></div>
                                    </div>
                                </div>
                            </li>
                            <li>
                                <button type="submit" id='bookingSubmit' class='form__submit' value='Send Reservation'>
                            </li>
                        </ul>       
                    </form>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    

   <script>
    document.querySelectorAll(".delete-res").forEach(i => {
        i.addEventListener("click", async (e) => {
            let id = e.target.dataset.id
            let response = await fetch("/admin/delete/" + id)

            response = await response.json()
            if(response.ok) window.location.reload()
       
        })
    })
    
    
 </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa" crossorigin="anonymous"></script>
</body>

 
 

</html> 